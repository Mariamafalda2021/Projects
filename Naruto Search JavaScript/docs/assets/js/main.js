"use strict";let favourites=[],seriesResult=[],searchedSerie="";const apiUrl="https://api.jikan.moe/v3/search/anime?q=",getApiData=()=>{fetch(`${apiUrl}${searchedSerie}`).then(e=>e.json()).then(e=>{seriesResult=e.results,console.log(seriesResult),paintSeries(),addListenerCard()})},resultsSection=document.querySelector(".js-resultsSection"),getSeriesHtmlCode=e=>{let t='<article class= "card js-cardFavourite ">';return t+=`<img src = "${e.image_url}" class= "card__img" alt = "Serie: ${e.title}" data-id="${e.mal_id}">`,t+=`<h3 class= "serie_title"> ${e.title}</h3 >`,t+="</article>",t},paintSeries=()=>{let e="";for(const t of seriesResult)e+=getSeriesHtmlCode(t);resultsSection.innerHTML+=e},inputBox=document.querySelector(".js-input_search"),searchBtn=document.querySelector(".js-button_search");function handlerSearchBtn(){searchedSerie=inputBox.value,fetch(`${apiUrl}${searchedSerie}`).then(e=>e.json()).then(e=>{seriesResult=e.results,console.log(seriesResult),paintSeries(),addListenerCard()}),addListenerCard()}searchBtn.addEventListener("click",handlerSearchBtn);const favouriteSection=document.querySelector(".js-favouriteSection");function addListenerCard(){const e=document.querySelectorAll(".js-cardFavourite");for(const t of e)t.addEventListener("click",addFavouriteSerie)}const addFavouriteSerie=e=>{const t=parseInt(e.target.dataset.id);let r;for(const e of favourites)e.id===t&&(r=e);if(void 0===r){let e;for(const r of seriesResult)r.mal_id===t&&(e=r);favourites.push({id:e.mal_id,title:e.title,image_url:e.image_url})}else console.log("esta repetido",r);setInLocalStorage(),paintFavouriteCard()},getFavouritesHtmlCode=e=>{let t='<article class= "favourite-card js-cardFavourite ">';return t+=`<img src = "${e.image_url}" class= "card__img" alt = "Serie: ${e.title}" data-id="${e.id}">`,t+=`<h3 class= "serie_title"> ${e.title}</h3 >`,t+=`<input type="button" class="js-remove" value="X" data-id="${e.id}">`,t+="</article>",t};function paintFavouriteCard(){let e="";if(0===favourites.length)favouriteSection.innerHTML="<h2>Favoritos</h2>";else for(const t of favourites)e+=getFavouritesHtmlCode(t),favouriteSection.innerHTML="<h2>Favoritos</h2>",favouriteSection.innerHTML+=e;addListenerRemoveBtn()}function handleDeleteFavourite(e){const t=e.target.dataset.id;if(console.log(favourites.length),1===favourites.length)favourites.splice(0,1);else for(let e=0;e<favourites.length;e++)console.log(favourites[e].id),t==favourites[e].id&&favourites.splice(e,1);paintFavouriteCard()}function addListenerRemoveBtn(){const e=document.querySelectorAll(".js-remove");for(const t of e)t.addEventListener("click",handleDeleteFavourite);console.log("click en borrar")}const resetBtn=document.querySelector(".js-resetBtn");function handlerResetBtn(e){e.preventDefault(),inputBox.value="",resultsSection.innerHTML="<h2>Resultados</h2>"}resetBtn.addEventListener("click",handlerResetBtn);const getFromLocalStorage=()=>{const e=JSON.parse(localStorage.getItem("favourites"));null!==e&&(favourites=e,paintFavouriteCard())},setInLocalStorage=()=>{const e=JSON.stringify(favourites);localStorage.setItem("favourites",e)};getFromLocalStorage();